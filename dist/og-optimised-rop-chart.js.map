{"version":3,"sources":["og-optimised-rop-chart.es6.js"],"names":["Polymer","is","properties","width","type","Number","value","height","margin","Object","top","right","bottom","left","observer","data","axisData","notify","legendAlignment","String","currentChartType","__defaultAxisData","ready","scopeSubtree","$","chart","attached","_setupDefaults","length","draw","d3","Px","x","y","_prepareChartingArea","_prepareAxes","_drawGridLines","_drawAxes","_drawCurrentDepthSeparator","_drawChart","fire","axisColor","customStyle","tickColor","updateStyles","adjustedWidth","adjustedHeight","select","remove","svg","append","attr","toolTip","tip","offset","html","d","msg","call","scaleLinear","range","clamp","allX","current","forecast","allY","optimised","actual","recommended","domain","start","extent","niceTicks","nice","yScaledMin","hideGrid","axisBottom","ticks","totalGridLines","tickSize","tickFormat","axisLeft","currentDepth","_axisData","style","color","dashArray","_plotActual","_plotOptimized","_plotRecommended","actualRadius","actualRop","radius","_data","forEach","pt","idx","push","selectAll","enter","i","circleStroke","_plotLineAndDot","optimisedRop","recommendedRop","name","dotRadius","line","interpolation","curve","datum","on","prefix","label","show","hide","_xAxis","format","_yAxis","axisLabel","text","_redraw","newData","oldData","_toggleSeries","event","target","dataset","id","querySelectorAll","elt","display","_toggleChartType","_hideChartTypeIcon"],"mappings":"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","file":"og-optimised-rop-chart.js","sourcesContent":["(function() {\n  Polymer({\n\n    is: 'og-optimised-rop-chart',\n\n    properties: {\n      /**\n      * Width of the Chart.\n      *\n      * @property width\n      */\n      width: {\n\t\t\t\ttype: Number,\n\t\t\t\tvalue: 960\n      },\n      /**\n      * Height of the Chart.\n      *\n      * @property height\n      */\n\t\t\theight: {\n\t\t\t\ttype: Number,\n\t\t\t\tvalue: 300\n      },\n      /**\n      * Margin of the Chart.\n      Eg: {top: 20, right: 20, bottom: 30, left: 50}\n      *\n      * @property margin\n      */\n      margin: {\n\t\t\t\ttype: Object,\n\t\t\t\tvalue() {\n\t\t\t\t\treturn {top: 20, right: 20, bottom: 30, left: 50};\n\t\t\t\t},\n\t\t\t\tobserver: '_redraw'\n\t\t\t},\n      /**\n      * Chart Data\n      * Format: {\"current\": {\"x\": [1,2,3], \"optimised\": [1,2,3], \"actual\": [2,4,5]}, \n        \"forecast\": {\"x\": [1,2,3], \"recommended\": [1,2,3]}\n      * @property data\n      */\n      data: {\n\t\t\t\ttype: Object,\n\t\t\t\tobserver: '_redraw'\n      },\n      /**\n       * Axis Data\n       *\n       * @property axisData\n       */\n      axisData: {\n        type: Object,\n        notify: true,\n        observer: '_redraw'\n      },\n      /**\n       * Legend Alignment\n       * Eg: right, left, center\n       *\n       * @property legendAlignment\n       */\n      legendAlignment: {\n        type: String,\n        value: \"left\"\n      },\n\n      currentChartType: {\n        type: String,\n        value: \"line\"\n      }\n    },\n\n    __defaultAxisData: {\n        \"x\": {\n          \"color\": \"\",\n          \"axisLabel\": \"Measured Depth\",\n          \"unit\": \"\",\n          \"tickFormat\": \"\",\n          \"tickTimeFormat\": \"\",\n          \"hideGrid\": true,\n          \"d3NiceType\": \"\",\n          \"niceTicks\": 0,\n          \"start\": 0,\n          \"axisColor\": \"#c1c0c0\",\n          \"tickColor\": \"#c1c0c0\"\n        },\n        \"y\": {\n          \"hideGrid\": false,\n          \"axisLabel\": \"Rate of Penetration\",\n          \"axisColor\": \"#c1c0c0\",\n          \"tickColor\": \"#c1c0c0\",\n          \"niceTicks\": 6,\n          \"tickFormat\": \"\",\n          \"start\": 0,\n          \"dotRadius\": 2, \n          \"actualRop\": {\n            \"color\": \"#518bb4\",\n            \"dashArray\": \"\",\n            \"radius\": 4,\n            \"circleStroke\": \"#518bb4\",\n            \"legendLabel\": \"Actual ROP\",\n            \"unit\": \"ft/hr\",\n            \"interpolation\": \"\"\n          },\n          \"optimisedRop\": {\n            \"color\": \"#f05c56\",\n            \"dashArray\": \"\",\n            \"legendLabel\": \"Optimized ROP\",\n            \"unit\": \"ft/hr\",\n            \"interpolation\": \"\"\n          },\n          \"recommendedRop\": {\n            \"color\": \"#f05c56\",\n            \"dashArray\": \"2,2\",\n            \"unit\": \"ft/hr\",\n            \"legendLabel\": \"Recommended ROP\",\n            \"interpolation\": \"\"\n          },\n          \"currentDepth\": {\n            \"color\": \"#c1c0c0\",\n            \"dashArray\": \"\",\n            \"unit\": \"ft\",\n            \"legendLabel\": \"Current Depth\"\n          }\n        }\n    },\n\n    ready() {\n      this.scopeSubtree(this.$.chart, true);\n    },\n\n    attached() {\n      this._setupDefaults();\n      if(this.data && this.data.length) {\n        this.draw();\n      }\n    },\n\n    draw() {\n      let d3 = Px.d3, data = this.data;\n      if(!data || !this.axisData || !this.axisData.x || !this.axisData.y) {return;}\n      this._prepareChartingArea();\n      this._prepareAxes(data);\n      this._drawGridLines(data);\n      this._drawAxes(data);\n      this._drawCurrentDepthSeparator(data);\n      this._drawChart(data);\n\n      this.fire(\"chart-drawn\", {});\n    },\n    \n    _setupDefaults() {\n      this.axisData = this.axisData ? this.axisData : this.__defaultAxisData;\n      this.axisData.x = this.axisData.x ? this.axisData.x : this.__defaultAxisData.x;\n      this.axisData.y = this.axisData.y ? this.axisData.y : this.__defaultAxisData.y;\n\n      if(this.axisData.x.axisColor) {\n        this.customStyle['--x-axis-color'] = this.axisData.x.axisColor;\n      }\n      if(this.axisData.x.tickColor) {\n        this.customStyle['--x-tick-color'] = this.axisData.x.tickColor;\n      }\n      if(this.axisData.y.axisColor) {\n        this.customStyle['--y-axis-color'] = this.axisData.y.axisColor;\n      }\n      if(this.axisData.y.tickColor) {\n        this.customStyle['--y-tick-color'] = this.axisData.y.tickColor;\n      }\n      this.updateStyles();\n    },\n\n    _prepareChartingArea() {\n      let d3 = Px.d3;\n      // set the dimensions and margins of the graph\n      this.margin = this.margin || {top: 30, right: 20, bottom: 40, left: 50},\n      this.adjustedWidth = this.width - this.margin.left - this.margin.right,\n      this.adjustedHeight = this.height - this.margin.top - this.margin.bottom;\n\n      d3.select(this.$.chart).select(\"svg\").remove();\n      this.svg = d3.select(this.$.chart).append(\"svg\")\n          .attr(\"viewBox\", \"0 0 \"+this.width+\" \"+this.height)\n          .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\n        .append(\"g\")\n          .attr(\"transform\",\n                \"translate(\" + this.margin.left + \",\" + this.margin.top + \")\");\n\n      this.toolTip = d3.tip(d3.select(this.$.chart))\n        .attr(\"class\", \"d3-tip\")\n        .offset([-8, 0])\n        .html(function(d) {\n          return d.msg;\n        });\n\n      this.svg.call(this.toolTip);\n    },\n    _prepareAxes(data) {\n      // set the ranges\n      let d3 = Px.d3;\n      this.x= d3.scaleLinear().range([0, this.adjustedWidth]);\n      this.y = d3.scaleLinear().range([this.adjustedHeight, 0]).clamp(true);\n\n      let x = this.x, y = this.y;\n\n      let allX = [...data.current.x, ...data.forecast.x];\n      let allY = [...data.current.optimised, \n          ...data.current.actual, ...data.forecast.recommended];\n\n      x.domain(this.axisData.x.start ? [this.axisData.x.start, d3.extent(allX)[1]] : d3.extent(allX));\n      y.domain(this.axisData.y.start ? [this.axisData.y.start, d3.extent(allY)[1]] : d3.extent(allY));\n\n      if(this.axisData.x.niceTicks) {\n        x.nice(this.axisData.x.niceTicks);\n      } else {\n        x.nice();\n      }\n      if(this.axisData.y.niceTicks) {\n        y.nice(this.axisData.y.niceTicks);\n      }\n    },\n    _drawGridLines(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n      let yScaledMin = y(y.domain()[0]);\n      if(!this.axisData.x.hideGrid) {\n        this.svg.append(\"g\")\n          .attr(\"class\", \"grid x-grid\")\n          .call(d3.axisBottom(x)\n              .ticks(this.axisData.x.totalGridLines || 5)\n              .tickSize(this.adjustedHeight)\n              .tickFormat(\"\"));\n      }\n\n      if(!this.axisData.y.hideGrid) {\n        this.svg.append(\"g\")\n          .attr(\"class\", \"grid y-grid\")\n          .call(d3.axisLeft(y)\n              .ticks(this.axisData.y.totalGridLines || 5)\n              .tickSize(-this.adjustedWidth)\n              .tickFormat(\"\"));\n      }\n    },\n    _drawCurrentDepthSeparator(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n      let currentDepth = data.forecast.x[0],\n      _axisData = this.axisData.y.currentDepth;\n      this.svg.append(\"svg:line\")\n        .attr(\"class\", \"current-depth\")\n        .style(\"stroke\", _axisData.color || this.axisData.y.axisColor)\n        .style(\"stroke-dasharray\", _axisData.dashArray || \"2,2\")\n        .attr(\"x1\", x(currentDepth))\n        .attr(\"y1\", this.adjustedHeight+18)\n        .attr(\"x2\", x(currentDepth))\n        .attr(\"y2\", -7);\n    },\n    _drawChart(data) {\n      this._plotActual(data);\n      this._plotOptimized(data);\n      this._plotRecommended(data);\n    },\n    _plotActual(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n      \n      let actualRadius = 2, _axisData = this.axisData.y.actualRop;\n      if(_axisData.radius !== 0) {\n        actualRadius = _axisData.radius || 2;\n      }\n\n      let _data = [];\n      data.current.x.forEach((pt, idx) => {\n        _data.push([+pt, +data.current.actual[idx]])\n      });\n\n      this.svg.selectAll(\".dot\")\n        .data(_data)\n        .enter()\n          .append(\"circle\")\n          .attr(\"r\", actualRadius)\n          .attr(\"cx\", (d, i) => x(d[0]))\n          .attr(\"cy\", (d) => y(d[1]))\n          .style(\"stroke\", _axisData.circleStroke || _axisData.color || \"steelblue\")\n          .style(\"display\", \"none\")\n          .attr(\"fill\", _axisData.color || \"steelblue\")\n          .attr(\"class\", \"series-actual actual-scatter\");\n\n      this._plotLineAndDot(_axisData, _data, 'actual');\n    },\n    _plotOptimized(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n      \n      let _axisData = this.axisData.y.optimisedRop;\n      let _data = [];\n      data.current.x.forEach((pt, idx) => {\n        _data.push([+pt, +data.current.optimised[idx]])\n      });\n      this._plotLineAndDot(_axisData, _data, 'optimised');\n    },\n    _plotRecommended(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n      \n      let _axisData = this.axisData.y.recommendedRop;\n      let _data = [];\n      data.forecast.x.forEach((pt, idx) => {\n        _data.push([+pt, +data.forecast.recommended[idx]])\n      });\n      this._plotLineAndDot(_axisData, _data, 'recommended');\n    },\n    _plotLineAndDot(_axisData, data, name) {\n      let x = this.x, y = this.y, d3 = Px.d3, radius = this.axisData.y.dotRadius;\n      let line = d3.line()\n          .x(function(d) { return x(d[0]); })\n          .y(function(d) { return y(d[1]); });\n\n      if(_axisData.interpolation) {\n        line.curve(d3[_axisData.interpolation]);\n      }\n\n      this.svg.append(\"path\")\n        .datum(data)\n        .attr(\"class\", `series-${name} ${name}-line`)\n        .style(\"stroke\", _axisData.color || \"steelblue\")\n        .style(\"stroke-dasharray\", _axisData.dashArray || \"0,0\")\n        .attr(\"fill\", \"transparent\")\n        .attr(\"d\", line)\n        .style(\"pointer-events\", \"none\");\n\n      this.svg.selectAll(\".dot\")\n        .data(data)\n        .enter()\n          .append(\"circle\")\n          .attr(\"r\", radius)\n          .attr(\"cx\", (d, i) => x(d[0]))\n          .attr(\"cy\", (d) => y(d[1]))\n          .attr(\"fill\", _axisData.color || \"steelblue\")\n          .attr(\"class\", `series-${name}`)\n          .on('mouseover', (d, i) => {\n            d3.select(this)\n              .attr('r', radius + 2);\n            let prefix = _axisData.label ? _axisData.label + \": \" : \"\";\n            d.msg = prefix + d[1];\n            this.toolTip.show(d);\n          })\n          .on('mouseout', (d) => {\n            d3.select(this)\n              .attr('r', radius);\n            this.toolTip.hide(d);\n          });\n    },\n    _drawAxes(data) {\n      let x = this.x, y = this.y, d3 = Px.d3;\n\n      // Add the X Axis\n      let _xAxis = d3.axisBottom(x);\n      _xAxis.tickFormat(d3.format(this.axisData.x.tickFormat));\n\n      this.svg.append(\"g\")\n          .attr(\"transform\", \"translate(0,\" + this.adjustedHeight + \")\")\n          .attr(\"class\", \"x-axis\")\n          .call(_xAxis);\n\n      // Add the Y Axis\n      let _yAxis = d3.axisLeft(y).ticks(this.axisData.y.niceTicks || 6);\n      if(this.axisData.y.tickFormat) {\n        _yAxis.tickFormat(d3.format(this.axisData.y.tickFormat));\n      }\n      this.svg.append(\"g\")\n          .attr(\"class\", \"y-axis\")\n          .call(_yAxis);\n\n      if(this.axisData.y.axisLabel) {\n        this.svg.append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 0 - this.margin.left)\n          .attr(\"x\",0 - (this.adjustedHeight / 2))\n          .attr(\"dy\", \"1em\")\n          .attr(\"class\", \"y-axis-label\")\n          .text(this.axisData.y.axisLabel);\n      }\n\n      if(this.axisData.x.axisLabel) {\n        this.svg.append(\"text\")\n          .attr(\"dy\", \"1em\")\n          .attr(\"class\", \"x-axis-label\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"transform\", \"translate(\"+ \n            (this.adjustedWidth/2) +\",\"+(this.adjustedHeight + this.margin.top)+\")\")\n          .text(this.axisData.x.axisLabel);\n      }\n    },\n\n    _redraw(newData, oldData) {\n      Px.d3.select(this.$.chart).select(\"svg\").remove();\n      this.draw();\n    },\n\n    _toggleSeries(event) {\n      const label = \"series-\" + event.target.dataset.id;\n\n      this[label] = !this[label];\n\t\t\tif(this[label]) {\n\t\t\t\tthis.querySelectorAll(\".\"+label).forEach((elt) => {\n\t\t\t\t\telt.style.display = \"none\";\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.querySelectorAll(\".\"+label).forEach((elt) => {\n\t\t\t\t\telt.style.display = \"block\";\n\t\t\t\t});\n\t\t\t}\n    },\n\n    _toggleChartType() {\n      this.currentChartType = this.currentChartType === 'line' ? 'scatter' : 'line';\n      if(this.currentChartType === 'scatter') {\n        this.querySelectorAll(\".actual-line\").forEach((elt) => {\n\t\t\t\t\telt.style.display = \"none\";\n        });\n        this.querySelectorAll(\".actual-scatter\").forEach((elt) => {\n\t\t\t\t\telt.style.display = \"block\";\n\t\t\t\t});\n      } else {\n        this.querySelectorAll(\".actual-line\").forEach((elt) => {\n\t\t\t\t\telt.style.display = \"block\";\n        });\n        this.querySelectorAll(\".actual-scatter\").forEach((elt) => {\n\t\t\t\t\telt.style.display = \"none\";\n\t\t\t\t});\n      }\n    },\n\n    _hideChartTypeIcon(type, currentChartType) {\n      currentChartType = currentChartType || 'line';\n      return type == currentChartType;\n    }\n  });\n})();\n"]}